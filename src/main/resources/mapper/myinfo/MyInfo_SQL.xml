<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- 2020.02.11. PM6:10 -->

<mapper namespace="myInfo">

<!-- 일반회원 상세정보 꺼내오기 -->
<select id = "selectmeminfo" parameterType = "hashmap" resultType = "hashmap">
	<![CDATA[
		SELECT * FROM MEMBER
		WHERE MEM_ID = #{MEM_ID}
	]]>
</select>
 
<!-- 펫시터 상세정보 꺼내오기 -->
<select id = "selectpstinfo" parameterType = "hashmap" resultType = "hashmap">
	<![CDATA[
		SELECT * FROM PETSITTER
		WHERE PSMEM_ID = #{PSMEM_ID}
	]]>
</select>

<!-- 펫시터 추가상세정보 꺼내오기 -->
<select id = "selectpstaddinfo" parameterType = "hashmap" resultType = "hashmap">
	<![CDATA[
		SELECT * FROM PETSITTER_ADD
		WHERE PSMEM_ID = #{PSMEM_ID}
	]]>
</select>

<!-- 펫시터 자격증정보 꺼내오기 -->
<select id = "selectcertiinfo" parameterType = "hashmap" resultType = "hashmap">
	<![CDATA[
		SELECT * FROM CERTI_FILE
		WHERE PSMEM_ID = #{PSMEM_ID}
	]]>
</select>


<!-- 회원/펫 프로필 정보 꺼내오기 --> <!-- 일단 일반회원 먼저 테스트후 성공하면 ID로 바꿔서 다시 수정 -->
<select id = "selectProfileInfo" parameterType = "hashmap" resultType = "hashmap">
	<![CDATA[
		SELECT * FROM PROFILE_FILE
		WHERE ID = #{ID}    
	]]>
</select>




<!-- 프로필사진 꺼내오기 -->
<select id="selectProfile" parameterType="hashmap" resultType="hashmap">
	<![CDATA[
		SELECT	PROFILE_STORED_FILE_NAME FROM PROFILE_FILE
		WHERE ID = #{ID}
	]]>
</select>


<!-- 일반 회원 정보 수정 --> <!-- 로그인한 값(MEM_ID인지 PSMEM_ID인지)으로 조건을 줘 MEM_ID에 값이 있을 경우, 코드 앞에서 이 쿼리문이 포함된 메서드를 작동하도록 한다. -->
<!-- (예. if(mem_id != null && mem_id != "") {
	이 쿼리문(일반 회원 전용)이 작동
     } else if(psmem_id != null && psmem_id != "") {
	펫시터 회원 전용 쿼리문 작동
     }...     ) -->

<!-- 일반회원 회원정보 수정 -->
<update id="updatememinfo" parameterType="hashMap">
	<![CDATA[
		UPDATE
			MEMBER
		SET
			PASSWORD1 = #{PASSWORD1},
			PASSWORD2 = #{PASSWORD2},
			PHONE = #{PHONE}, 
			EMAIL = #{EMAIL},
			BIRTHDAY = #{BIRTHDAY},
			ZIPCODE = #{ZIPCODE},
			ADDRESS1 = #{ADDRESS1},
			ADDRESS2 = #{ADDRESS2},
			ADDRESS_ADD = #{ADDRESS_ADD}
		WHERE
		
			MEM_ID = #{MEM_ID}				
	]]>
</update>

<!-- 펫시터 회원정보 수정 -->
<update id="updatepstinfo" parameterType="hashMap">
	<![CDATA[
		UPDATE
			PETSITTER
		SET
			PASSWORD1 = #{PASSWORD1},
			PASSWORD2 = #{PASSWORD2},
			PHONE = #{PHONE},
			EMAIL = #{EMAIL},
			BIRTHDAY = #{BIRTHDAY},
			ZIPCODE = #{ZIPCODE},
			ADDRESS1 = #{ADDRESS1},
			ADDRESS2 = #{ADDRESS2},
			ADDRESS_ADD = #{ADDRESS_ADD}
		WHERE
		
			PSMEM_ID = #{PSMEM_ID}				
	]]>
</update>

<!-- 펫시터 추가회원정보 수정 -->
<update id="updatepstaddinfo" parameterType="hashMap">
	<![CDATA[
		UPDATE
			PETSITTER_ADD
		SET
			PSMEM_JOB = #{PSMEM_JOB},
			PSMEM_CERTI_CHECK = #{PSMEM_CERTI_CHECK},
			PSMEM_SCHOOL_FINISH_CHECK = #{PSMEM_SCHOOL_FINISH_CHECK},
			PSMEM_CAREER = #{PSMEM_CAREER},
			PSMEM_INTRODUCE = #{PSMEM_INTRODUCE}		
		WHERE		
			PSMEM_ID = #{PSMEM_ID}				
	]]>
</update>


<!-- 펫시터 자격증 수정 파일 업로드 수정을 추후에 -->
<update id="updatecertiinfo" parameterType="hashMap">
	<![CDATA[
		UPDATE
			CERTI_FILE
		SET
			CERTI_NAME = #{CERTI_NAME},
			CERTI_ORG = #{CERTI_ORG},
			CERTI_DATE = #{CERTI_DATE},
			PROFILE_ORIGINAL_FILE_NAME = #{PROFILE_ORIGINAL_FILE_NAME},
			PROFILE_FILE_SIZE = #{PROFILE_FILE_SIZE},
			PROFILE_STORED_FILE_NAME = #{PROFILE_STORED_FILE_NAME}			
		WHERE		
			PSMEM_ID = #{PSMEM_ID}				
	]]>
</update>




<!-- 일반 회원 탈퇴 -->
<delete id="deleteMember" parameterType="hashmap"> 
	<![CDATA[
		DELETE FROM MEMBER
		WHERE MEM_ID = #{MEM_ID}
	]]>
</delete>


<!-- 일반회원 펫 정보 불러오기 -->
<select id = "selectmypet" parameterType = "hashmap" resultType = "hashmap">
	<![CDATA[
		SELECT * FROM PET_MEMBER
		WHERE ID = #{ID}
	]]>
</select>


<!-- 프로필이미지 수정 -->
<update id="updateProfile" parameterType="hashmap">
	<![CDATA[
		UPDATE
			PROFILE_FILE
		SET
			PROFILE_ORIGINAL_FILE_NAME = #{PROFILE_ORIGINAL_FILE_NAME},
			PROFILE_FILE_SIZE = #{PROFILE_FILE_SIZE},
			PROFILE_STORED_FILE_NAME = #{PROFILE_STORED_FILE_NAME}
		WHERE
			PROFILE_NO = #{PROFILE_NO} AND ID = #{ID}	
	]]>
</update>


<!-- 파일 리스트 -->
 <select id="selectPstPlaceList" parameterType="hashmap" resultType="hashmap">
	<![CDATA[
		SELECT
		     PSMEM_FILE_NO,
		     PSMEM_ORIGINAL_FILE_NAME,
		     ROUND(PSMEM_FILE_SIZE/1024,1) AS PSMEM_FILE_SIZE
			
		FROM
		     PETSITTER_ADD_IMG
		WHERE
		     PSMEM_ID = #{ID}  AND FILE_DEL = 'N'
		]]>
</select> <!-- BOARD_FILE_NO -->

<!-- 위탁장소 파일 삭제 -->
<update id="deleteFile" parameterType="hashmap">
		<![CDATA[
			UPDATE PETSITTER_ADD_IMG
			SET 
				FILE_DEL = 'Y' 
			WHERE 
				PSMEM_ID = #{PSMEM_ID}
		]]>
</update>


<!-- 위탁장소 파일 수정 -->
<update id="updateFile" parameterType="hashmap">
		<![CDATA[
			UPDATE PETSITTER_ADD_IMG
			SET
				FILE_DEL = 'N'
			WHERE
				PSMEM_FILE_NO = #{PSMEM_FILE_NO}	
		]]>
</update>

<!-- 찜 등록 -->
<insert id="insertBookmark" parameterType="hashmap">
		<![CDATA[
			INSERT INTO MYPAGE_BOOK_MARK (
				MYPAGE_BOOK_MARK_NO,
				MEM_ID,
				PSMEM_ID,
				MYPAGE_BOOK_MARK_DATE
			)
			VALUES(
				MYPAGE_BOOK_MARK_SEQ.NEXTVAL,
				#{MEM_ID},
				#{PSMEM_ID},
				SYSDATE
			)
		]]>
</insert>

<!-- 찜 리스트 뽑기 -->
<select id="BookmarkList" parameterType="hashmap">
		<![CDATA[
			SELECT *
			FROM
				MYPAGE_BOOK_MARK
			WHERE
				#{MEM_ID}
		]]>
</select>
	
</mapper>